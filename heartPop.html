<html>
  <head>
    <title>Valentine's Day | Heart Shape CSS</title>
    <link rel="icon" type="image/png" href="../../favicon_32_32_compress.ico" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <style>
      /* Your existing CSS styles */
    </style>
  </head>
  <body>
    <div class="circle" id="circle"></div>
    <div class="center">
      <div class="heart" onclick="toggle(this)">
        <p id="textInner" class="heart-text" style="opacity: 0; display: none">
          Happy Kiss Day
          <br />
          üíã‚ù§Ô∏è
        </p>
        <p class="instructions">Want kiss? <br> Click me!</p> <br>
      </div>
    </div>
    <!-- Remove preload="auto" -->
    <audio id="valentineSong" src="kissVoice.ogg"></audio>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@latest"></script>
    <script>
      function toggle(element) {
        element.classList.toggle("clicked");
        if (element.classList.contains("clicked")) {
          document.getElementById("textInner").style.display = "block";
          setTimeout(() => {
            document.getElementById("textInner").style.opacity = "1";
          }, 100);
          createConfetti();
          playSongSegment(0.6, 2); // Play audio on user click
        } else {
          document.getElementById("textInner").style.opacity = "0";
          setTimeout(() => {
            document.getElementById("textInner").style.display = "none";
          }, 300);
          stopSong();
        }
      }

      function playSongSegment(startTime, endTime) {
        const audio = document.getElementById("valentineSong");
        audio.currentTime = startTime;
        audio.play().catch(error => {
          console.error("Audio playback failed:", error);
          // Handle the error (e.g., show a message to the user)
        });

        setTimeout(() => {
          audio.pause();
          audio.currentTime = startTime;
        }, (endTime - startTime) * 1000);
      }

      function stopSong() {
        const audio = document.getElementById("valentineSong");
        audio.pause();
        audio.currentTime = 40;
      }

      function createConfetti() {
        const canvas = document.createElement("canvas");
        const context = canvas.getContext("2d");

        const emojiShape = confetti.shapeFromText({
          text: "üíã",
          scalar: 3,
        });

        confetti({
          particleCount: 225,
          scalar: 5,
          angle: 90,
          spread: 360,
          startVelocity: 25,
          decay: 0.95,
          shapes: [emojiShape],
          origin: { x: 0.5, y: 0.4 },
          zIndex: -1,
        });
      }

      const circle = document.getElementById('circle');

      circle.addEventListener('click', () => {
        if (!circle.classList.contains('expand')) {
          circle.classList.add('expand');
        }
      });

      circle.addEventListener('transitionend', () => {
        if (circle.classList.contains('expand')) {
          window.location.href = 'main.html';
        }
      });
    </script>
    <script type="text/javascript">
      var sc_project = 12947838;
      var sc_invisible = 1;
      var sc_security = "64126f45";
    </script>
    <script
      type="text/javascript"
      src="https://www.statcounter.com/counter/counter.js"
      async
    ></script>
    <noscript>
      <div class="statcounter">
        <a title="Web Analytics" href="https://statcounter.com/" target="_blank"
          ><img
            class="statcounter"
            src="https://c.statcounter.com/12947838/0/64126f45/1/"
            alt="Web Analytics"
            referrerpolicy="no-referrer-when-downgrade"
        /></a>
      </div>
    </noscript>
  </body>
</html>
